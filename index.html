<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Keybordizer</title>
    <script src="https://unpkg.com/tone@13.8.25/build/Tone.js"></script>
</head>
<body>
    
    <div class='keyboard'>
        <div data-key='65' class='key'>A</div>
        <div data-key='83' class='key'>S</div>
        <div data-key='68' class='key'>D</div>
        <div data-key='70' class='key'>F</div>
        <div data-key='74' class='key'>J</div>
        <div data-key='75' class='key'>K</div>
        <div data-key='76' class='key'>L</div>
        <div data-key='186' class='key'>;</div>
    </div>


    <audio data-key='65' src='sounds/boom.wav'></audio>
    <audio data-key='83' src='sounds/hihat.wav'></audio>
    <audio data-key='68' src='sounds/clap.wav'></audio>
    <audio data-key='70' src='sounds/kick.wav'></audio>
    <audio data-key='74' src='sounds/openhat.wav'></audio>
    <audio data-key='75' src='sounds/ride.wav'></audio>
    <audio data-key='76' src='sounds/snare.wav'></audio>
    <audio data-key='186' src='sounds/tink.wav'></audio>

    <script>
        function removeTransition(e) {
            if (e.propertyName !== 'transform') return;
            e.target.classList.remove('playing');
        }

        function playsound(e) {
            const audio = document.querySelector(`audio[data-key="${e.keyCode}"]`);
            const key = document.querySelector(`div[data-key="${e.keyCode}"]`);
            if (!audio) return;

            key.classList.add('playing')
            audio.currentTime = 0;
            audio.play();
        }
        
        const keys = Array.from(document.querySelectorAll('.key'));
        keys.forEach(key => key.addEventListener('transitioned', removeTransition))
        window.addEventListener('keydown', playsound);
    </script>
</body>
</html>